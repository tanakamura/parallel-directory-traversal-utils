![workflow](https://github.com/tanakamura/parallel-directory-traverse-utils/actions/workflows/rust.yml/badge.svg)

# Parallel Directory Traversal Utils

ディレクトリ走査が必要なコマンドラインツール(du, find, ディレクトリクローン等)の高速な代替(を目指す)。

NVMe経由で接続されたNANDのような現代のストレージは、数GB/s程度、つまりDRAMと大差ない帯域を持つものが登場しており、既にPCのような一般的なコンピュータにも十分普及している。
しかし、古くからあるコマンドラインツールの多くは、ストレージがディスクの回転とヘッドのシークを必要とした頃に作られていて、現代のストレージの性能を引き出せるようには作られていない。

現代のストレージの性能を引き出すには、多くのIO要求をデバイスに叩き込むことが必要である。
HDDは、原理的に1個のヘッドで一個のデータを読むしかできず、SATA の NCQ は、シーク順序を効率化することにしか使われていない(はず)。しかし、NAND ストレージは、内部で並列化されている箇所があるため、NCQなどのコマンドキューの重要性はHDDよりも上がっており、これを有効活用するために、HDDよりも多くのIOを要求しなければならない。

巨大なファイルを扱う場合は、これは難しくない。巨大なread/write requestを投入すれば、ストレージ内で自動的に並列化される。
しかし、小さいファイルを大量に扱うときには、大量のファイルに対して並行に IO request を投入するプログラムを書かなければならない。


この Parallel Diretory Traversal Utils は、マルチスレッドとio_uring を使ってできるだけ多くの File 読み込み要求をストレージに投入し、du, find, ディレクトリクローン(like cp -a, rsync -arv)などを高速に実現することを目指す。


# memo
- ファイルの出力順がランダムにならないようにしています。
